<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <!-- Web Experience Toolkit (WET) / Boîte à outils de l'expérience Web (BOEW) wet-boew.github.io/wet-boew/License-en.html / wet-boew.github.io/wet-boew/Licence-fr.html -->
  <title>Canada Emergency Wage Subsidy (CEWS) – Canada.ca</title>
  <meta content="width=device-width,initial-scale=1" name="viewport">
  <meta name="robots" content="noindex">
  <!-- Meta data -->
  <!-- Meta data-->
  <!-- Load closure template scripts -->

  <script type="text/javascript"
    src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_30/cdts/compiled/soyutils.js"></script>
  <script type="text/javascript"
    src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_30/cdts/compiled/wet-en.js"></script>
  <link href="https://test.canada.ca/covid-19-guidance/proto/css/alpha-beta-banner.css" rel="stylesheet">
  <link href="../css/cews.css" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
    integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
  <!-- Write closure template -->
  <script type="text/javascript">
    document.write(wet.builder.refTop({
    }));
  </script>
</head>

<body vocab="http://schema.org/" typeof="WebPage">
  <div id="def-top">
  </div>
  <!-- Write closure template -->
  <script type="text/javascript">
    var defTop = document.getElementById("def-top");
    defTop.outerHTML = wet.builder.top({
      lngLinks: [{

        lang: "fr",
        href: "how-much-mt-fr.html",
        text: "Français"
      }],
      breadcrumbs: [{
        title: "Canada.ca",
        href: "https://www.canada.ca/en.html"
      }, {
        title: "Business and industry",
        href: "https://www.canada.ca/en/services/business.html"
      }, {
        title: "Canada Emergency Wage Subsidy (CEWS)",
        href: "index.html"
      }],
      search: true,
      siteMenu: true,
      showPreContent: true
    });
  </script>
  <main property="mainContentOfPage" class="container">
    <section class="gc-nav">
      <h1 property="name" id="wb-cont-nav">Canada Emergency Wage Subsidy (CEWS)</h1>
      <ul id="gc-navseq-nav" class="hidden-xs hidden-sm">
        <li> <a class="gc-navseq-nav-btn" href="#gc-navseq-header">Go to navigation menu</a> </li>
        <li> <a class="gc-navseq-nav-btn" href="#wb-cont">Skip to main content</a> </li>
      </ul>
      <nav aria-label="Section menu">
        <h2 id="gc-navseq-header" class="mrgn-tp-0 hidden-xs hidden-sm">Sections</h2>
        <ul class="gc-navseq">
          <li><a href="who-apply.html">Who is an eligible employer</a></li>
          <li><a href="who-employees.html">Determine your eligible employees</a></li>
          <li class="active"><a aria-current="page">Calculate your subsidy amount<span class="wb-inv">: Canada Emergency
                Wage Subsidy (CEWS)</span></a>
            <ul class="gc-navseq noline">
              <li><a href="how-much-reduction.html">How the eligible revenue reduction is calculated<span
                    class="wb-inv">: Canada Emergency Wage Subsidy (CEWS)</span></a></li>
              <li><a href="how-much-version-math.html">How the subsidy is calculated<span class="wb-inv">: Canada
                    Emergency Wage Subsidy (CEWS)</span></a></li>
            </ul>
          </li>
          <li><a href="how-apply.html">How to apply</a></li>
          <li><a href="after.html">After you apply</a></li>
          <li><a href="contact.html">Contact the CRA</a></li>

        </ul>
        <div class="hidden-sm hidden-xs" data-ajax-replace="index.html #related-menu>"> </div>
      </nav>
    </section>
    <section class="gc-nav-section experimental">
      <h1 property="name" id="wb-cont">Calculate your subsidy amount</h1>
      <p>When you apply for the Canada Emergency Wage Subsidy (CEWS), you will be asked to enter amounts such as the
        number of eligible employees and the eligible remuneration paid to them during the claim period. This calculator
        is a tool to help you determine some specific line amounts (lines A – G) that you will need to enter into the
        CEWS application form. You can determine these amounts and preview your estimated subsidy claim based on
        information you enter. You can also print your results and save them for future reference or to substantiate
        your claim.</p>
      <p>There is no limit on the total subsidy amount that you may claim as an eligible employer. After you apply for
        the wage subsidy, your claim will be subject to verification.</p>
      <p>To understand the math behind the subsidy calculation, refer to <a href="how-much-version-math.html">how the
          subsidy is calculated</a>.</p>
      <p><strong>Note:</strong> You must do a separate calculation and application for each payroll program (RP) account
        you have with the CRA.</p>

      <section>
        <div class="alert alert-info">
          <h3>Before you start</h3>
          <p>Before you calculate your subsidy, you will need to <a href="who-apply.html">make sure you are eligible to
              apply</a> and prepare some information.</p>
          <ol>
            <!--<li>Calculate the <a href="how-much-reduction.html">eligible reduction in revenue</a> you experienced for the claim period</li>-->
            <li>Know <a href="who-employees.html">which employees are eligible</a> to be included in your calculation.
              Use the calculator only for eligible employees. Do not include any amounts for ineligible employees.</li>
            <li>If you had any eligible employees furloughed during the claim period, calculate the amount of <a
                href="#contributions" aria-controls="contributions" class="wb-lbx" role="button">EI and QPIP, and CPP
                and QPP contributions&nbsp;<span class="far fa-question-circle"></span></a> you made on behalf of those
              employees.</li>
            <li>Know the amount you calculated for the <a href="#tempwage" aria-controls="tempwage" class="wb-lbx"
                role="button">10% Temporary Wage Subsidy for Employers program&nbsp;<span
                  class="far fa-question-circle"></span></a> for this claim period</li>
            <li>If you were participating in a <a href="#worksharing" aria-controls="worksharing" class="wb-lbx"
                role="button">Work-Sharing benefit program through Employment Insurance&nbsp;<span
                  class="far fa-question-circle"></span></a> for this claim period, determine the total amount your
              eligible employees received under the program.</li>
          </ol>
        </div>
        <p> <strong>Note:</strong> You may be required to provide a full list of your employees and their Social
          Insurance Numbers (SIN) for verification after you apply. The CRA is not collecting or retaining any of the
          information you enter on this page or in the calculation spreadsheet. These amounts are only used to help you
          determine the amount of CEWS you may be eligible to claim.</p>

        <!--INSERTED FORM BEGINS HERE-->
        <div class="wb-frmvld">
          <form method="get" class="mrgn-bttm-lg" id="cews-cal">
            <ol class="lst-stps">
              <li>
                <fieldset>
                  <legend>Claim period</legend>
                  <div class="form-group">
                    <label for="claim-period" class="control-label required"><span class="field-name">Select the period
                        you are claiming for</span> <strong class="required">(required)</strong></label>
                    <select required id="claim-period" class="form-control input-lg">
                      <option value=""> Select a claim period</option>
                      <option data-claim-period="1" value="2020-03-15--2020-04-11">March 15, 2020 to April 11, 2020</option>
                      <option data-claim-period="2" value="2020-04-12--2020-05-09">April 12, 2020 to May 9, 2020</option>
                      <option data-claim-period="3" value="2020-05-10--2020-06-06">May 10, 2020 to June 6, 2020</option>
                      <option data-claim-period="4" value="2020-06-07--2020-07-04">June 7, 2020 to July 4, 2020</option>
                      <option data-claim-period="5" value="2020-07-05--2020-08-01">July 5, 2020 to August 1, 2020</option>
                    </select>
                  </div>
                </fieldset>
                <hr class="brdr-bttm">
                <div class="well mrgn-tp-md mrgn-bttm-lg text-muted">
                  <h3 class="mrgn-tp-0"><span class="far fa-calendar-alt"></span> Summary of Step 1</h3>
                  <ul class="list-unstyled lst-spcd">
                    <li>Claim period is: <span class="h3 claim-period"></span></li>
                  </ul>
                </div>
              </li>
              <li>
                <fieldset class="brdr-tp">
                  <legend>Eligible remuneration for eligible employees</legend>
                  <div class="clearfix"></div>
                  <p>You may calculate the amount of eligible remuneration (pay) for your eligible employees and basic
                    CEWS using the calculation spreadsheet provided. </p>
                  <ol class="lst-lwr-alph">
                    <li class="mrgn-bttm-lg">
                      <p class="lead">Calculate the values using the online calculator or spreadsheet</p>
                      <p>If you have 20 eligible employees or less whose wages can be calculated either weekly or
                        bi-weekly (not both), you can use the online calculator. If you have more than 20 employees or
                        have various pay schedules, it is recommended to use the spreadsheet.</p>
                      <details>
                        <summary>
                          <h3>Online calculator for 20 employees or less</h3>
                        </summary>
                        <fieldset id="rate-reduction">
                          <legend>Calculate your rate reduction</legend>
                          <div>
                            <div class="wb-fieldflow" data-wb-fieldflow='{"isoptional": true, "noForm": true }'>
                              <p>Have you claimed CEWS before this period?</p>
                              <ul>
                                <li>Yes
                                  <div class="wb-fieldflow-sub" data-wb-fieldflow='{"isoptional": true }'>
                                    <p>Did you elect to use the alternate baseline period (average eligible revenue
                                      during January and February 2020) to determine your eligible revenue reduction?
                                    </p>
                                    <ul>
                                      <li
                                        data-wb-fieldflow='{"action": "toggle", "toggle": "#alt-bl-yes", "live": true}'>
                                        Yes </li>
                                      <li
                                        data-wb-fieldflow='{"action": "toggle", "toggle": "#alt-bl-no", "live": true}'>
                                        No</li>
                                    </ul>
                                  </div>
                                </li>
                                <li>No
                                  <div class="wb-fieldflow-sub" data-wb-fieldflow='{"isoptional": true }'>
                                    <p>Which baseline revenue comparison option will you use for this claim (and all
                                      future claims)?</p>
                                    <ul>
                                      <li
                                        data-wb-fieldflow='{"action": "toggle", "toggle": "#alt-bl-no", "live": true}'>
                                        Previous month in 2019 (for example, July 2019 to compare to current claim
                                        period of July 2020)</li>
                                      <li
                                        data-wb-fieldflow='{"action": "toggle", "toggle": "#alt-bl-yes", "live": true}'>
                                        Average of January and February 2019 (alternative baseline revenue)</li>
                                    </ul>
                                  </div>
                                </li>
                              </ul>
                            </div>
                            <div class="hidden" id="alt-bl-no">
                              <p><strong>Determine your rate of CEWS for the claim period</strong></p>
                              <fieldset>
                                <legend>Enter your eligible revenue for the following months</legend>
                                <div class="row">
                                  <div class="col-md-6 brdr-rght">
                                    <p><strong>2019 revenue</strong></p>
                                    <div class="form-group row">
                                      <label class="col-sm-6 control-label" for="2019-04-no">April 2019</label>
                                      <div class="col-sm-6">
                                        <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                          <input type="number" class="form-control currency cews-rate-calc" name="2019-04-no"
                                            id="2019-04-no" size="10">
                                        </div>
                                      </div>
                                    </div>
                                    <div class="form-group row">
                                      <label class="col-sm-6 control-label" for="2019-05-no">May 2019</label>
                                      <div class="col-sm-6">
                                        <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                          <input type="number" class="form-control currency  cews-rate-calc" name="2019-05-no"
                                            id="2019-05-no" size="10">
                                        </div>
                                      </div>
                                    </div>
                                    <div class="form-group row">
                                      <label class="col-sm-6 control-label" for="2019-06-no">June 2019</label>
                                      <div class="col-sm-6">
                                        <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                          <input type="number" class="form-control currency  cews-rate-calc" name="2019-06-no"
                                            id="2019-06-no" size="10">
                                        </div>
                                      </div>
                                    </div>
                                    <div class="form-group row">
                                      <label class="col-sm-6 control-label" for="2019-07-no">July 2019</label>
                                      <div class="col-sm-6">
                                        <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                          <input type="number" class="form-control currency  cews-rate-calc" name="2019-07-no"
                                            id="2019-07-no" size="10">
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-md-6">
                                    <p><strong>2020 revenue</strong></p>
                                    <div class="form-group row">
                                      <label class="col-sm-6 control-label" for="2020-04-no">April 2020</label>
                                      <div class="col-sm-6">
                                        <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                          <input type="number" class="form-control currency  cews-rate-calc" name="2020-04-no"
                                            id="2020-04-no" size="10">
                                        </div>
                                      </div>
                                    </div>
                                    <div class="form-group row">
                                      <label class="col-sm-6 control-label" for="2020-05-no">May 2020</label>
                                      <div class="col-sm-6">
                                        <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                          <input type="number" class="form-control currency  cews-rate-calc" name="2020-05-no"
                                            id="2020-05-no" size="10">
                                        </div>
                                      </div>
                                    </div>
                                    <div class="form-group row">
                                      <label class="col-sm-6 control-label" for="2020-06-no">June 2020</label>
                                      <div class="col-sm-6">
                                        <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                          <input type="number" class="form-control currency cews-rate-calc" name="2020-06-no"
                                            id="2020-06-no" size="10">
                                        </div>
                                      </div>
                                    </div>
                                    <div class="form-group row">
                                      <label class="col-sm-6 control-label" for="2020-07-no">July 2020</label>
                                      <div class="col-sm-6">
                                        <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                          <input type="number" class="form-control currency cews-rate-calc" name="2020-07-no"
                                            id="2020-07-no" size="10">
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </fieldset>
                              <div class="well text-muted mrgn-tp-md">
                                <h3 class="mrgn-tp-0"><span class="fas fa-calculator"></span> Summary of average revenue
                                </h3>
                                <ul class="list-unstyled">
                                  <li>Your CEWS rate of reduction for this claim period is: <span class="h3" id="cews-rate">XX%</span>
                                    <br>
                                    Which includes:
                                    <ul class="list-unstyled mrgn-lft-lg small">
                                      <li>Base rate (revenue reduction from July 2019 to July 2020): <span
                                          class="h4" id="rev-reduc-base">XX%</span></li>
                                      <li>Top-up rate (average revenue reduction from April, May and June 2019 to April,
                                        May and June 2020): <span class="h4" id="top-up-rate">XX%</span></li>
                                    </ul>
                                  </li>
                                </ul>
                              </div>
                            </div>
                            <div class="hidden" id="alt-bl-yes">
                              <p><strong>Determine your rate of CEWS for the claim period</strong></p>
                              <fieldset>
                                <legend>Enter your eligible revenue for the following months</legend>
                                <div class="row">
                                  <div class="col-md-6">
                                    <div class="form-group row">
                                      <label class="col-sm-6 control-label" for="2020-01-yes">January 2020</label>
                                      <div class="col-sm-6">
                                        <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                          <input type="number" class="form-control currency cews-rate-calc-alt" name="2020-01-yes"
                                            id="2020-01-yes" size="10">
                                        </div>
                                      </div>
                                    </div>
                                    <div class="form-group row">
                                      <label class="col-sm-6 control-label" for="2020-02-yes">February 2020</label>
                                      <div class="col-sm-6">
                                        <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                          <input type="number" class="form-control currency cews-rate-calc-alt" name="2020-02-yes"
                                            id="2020-02-yes" size="10">
                                        </div>
                                      </div>
                                    </div>
                                    <div class="form-group row">
                                      <label class="col-sm-6 control-label" for="2020-04-yes">April 2020</label>
                                      <div class="col-sm-6">
                                        <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                          <input type="number" class="form-control currency cews-rate-calc-alt" name="2020-04-yes"
                                            id="2020-04-yes" size="10">
                                        </div>
                                      </div>
                                    </div>
                                    <div class="form-group row">
                                      <label class="col-sm-6 control-label" for="2020-05-yes">May 2020</label>
                                      <div class="col-sm-6">
                                        <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                          <input type="number" class="form-control currency cews-rate-calc-alt" name="2020-05-yes"
                                            id="2020-05-yes" size="10">
                                        </div>
                                      </div>
                                    </div>
                                    <div class="form-group row">
                                      <label class="col-sm-6 control-label" for="2020-06-yes">June 2020</label>
                                      <div class="col-sm-6">
                                        <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                          <input type="number" class="form-control currency cews-rate-calc-alt" name="2020-06-yes"
                                            id="2020-06-yes" size="10">
                                        </div>
                                      </div>
                                    </div>
                                    <div class="form-group row">
                                      <label class="col-sm-6 control-label" for="2020-07-yes">July 2020</label>
                                      <div class="col-sm-6">
                                        <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                          <input type="number" class="form-control currency cews-rate-calc-alt" name="2020-07-yes"
                                            id="2020-07-yes" size="10">
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </fieldset>
                              <div class="well text-muted mrgn-tp-md">
                                <h3 class="mrgn-tp-0"><span class="fas fa-calculator"></span> Summary of average revenue
                                </h3>
                                <ul class="list-unstyled">
                                  <li>Your CEWS rate of reduction for this claim period is: <span class="h3" id="cews-rate-alt">XX%</span>
                                    <br>
                                    Which includes:
                                    <ul class="list-unstyled mrgn-lft-lg small">
                                      <li>Base rate (revenue reduction from January and February 2020 to July 2020):
                                        <span class="h4" id="rev-reduc-alt-base">XX%</span></li>
                                      <li>Top-up rate (average revenue reduction from January and February 2020 to
                                        April, May and June 2020): <span class="h4" id="top-up-rate-alt">XX%</span></li>
                                    </ul>
                                  </li>
                                </ul>
                              </div>
                            </div>
                          </div>
                        </fieldset>
                        <fieldset id="payroll">
                          <legend>Payroll details</legend>
                          <div>
                            <div class="form-group" id="reduction-percent-panel">
                              <label for="reduction-percent">Enter the percentage of revenue your business has lost in
                                the current claim period</label>
                              <p class="text-muted">Use the rate reduction calculator above</p>
                              <div class="input-group col-sm-3">
                                <input type="text" size="10" id="reduction-percent" name="reduction-percent"
                                  class="form-control" />
                                <span class="input-group-addon">%</span></div>
                            </div>
                          </div>
                        </fieldset>
                        <fieldset id="employees">
                          <legend>Calculate your employee's wages</legend>
                          <div id="employeeDiv">
                            <p>Include all your eligible employees.</p>
                            <fieldset class="panel panel-default p-0" id="wkly-emp-1">
                              <div class="panel-body">
                                <legend><span class="fas fa-user"></span> Eligible employee <span
                                    class="employeeNumber">1</span></legend>
                                <div class="form-group">
                                  <label for="wkly-arms-1" class="required"><span class="field-name"></span>Is employee at arm's length</span></label>
                                  <p><a class="wb-lbx" role="button" aria-controls="armslength" href="#armslength">Arm's
                                      length definition<span class="mrgn-lft-sm far fa-question-circle"></span></a></p>
                                  <select class="form-control" id="wkly-arms-1" required data-updates="emp-arms-1">
                                    <option>Select</option>
                                    <option value="yes">Yes</option>
                                    <option value="no">No</option>
                                  </select>
                                </div>
                                <hr>
                                <div class="form-group">
                                  <label for="wkly-baseline-1" class="required"><span class="field-name"></span>Average weekly baseline pay for January 1 to March 15,
                                    2020</span></label>
                                  <p><a class="wb-lbx" role="button" aria-controls="bl-def" href="#bl-def">Baseline pay
                                      definition<span class="far fa-question-circle mrgn-lft-sm"></span></a></p>
                                  <div class="input-group col-md-5"> <span class="input-group-addon">$</span>
                                    <input type="number" required class="form-control input-lg text-right currency" step="any"
                                      id="wkly-baseline-1" data-updates="emp-base-1">
                                  </div>
                                </div>
                                <fieldset>
                                  <legend>Eligible remuneration (pay) in respect of the claim period <span
                                      class="claim-period"></span>
                                  </legend>
                                  <div class="form-group row">
                                    <div class="col-md-3">
                                      <label for="wkly-wkone-1" class="required"><span class="field-name">Week one</span></label>
                                      <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                        <input required step="any" type="number"
                                          class="form-control text-right input-sm currency emp-wage emp-wkly-wage-1"
                                          data-updates="w1-amt-1" id="wkly-wkone-1">
                                      </div>
                                    </div>
                                    <div class="col-md-3">
                                      <label for="wkly-wktwo-1" class="required"><span class="field-name">Week two</span></label>
                                      <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                        <input required type="number"
                                          class="form-control text-right currency emp-wage emp-wkly-wage-1" step="any"
                                          id="wkly-wktwo-1" data-updates="w2-amt-1">
                                      </div>
                                    </div>
                                    <div class="col-md-3">
                                      <label for="wkly-wkthree-1" class="required"><span class="field-name">Week three</span></label>
                                      <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                        <input required type="number"
                                          class="form-control text-right currency emp-wage emp-wkly-wage-1" step="any"
                                          id="wkly-wkthree-1" data-updates="w3-amt-1">
                                      </div>
                                    </div>
                                    <div class="col-md-3">
                                      <label for="wkly-wkfour-1" class="required"><span class="field-name">Week four</span></label>
                                      <div class="input-group"> <span class="input-group-addon input-sm">$</span>
                                        <input required type="number"
                                          class="form-control text-right currency emp-wage emp-wkly-wage-1" step="any"
                                          id="wkly-wkfour-1" data-updates="w4-amt-1">
                                      </div>
                                    </div>
                                  </div>
                                </fieldset>
                              </div>
                              <footer class="panel-footer">
                                <details>
                                  <summary><span class="fas fa-calculator"></span> Calculation summary for employee
                                    <span class="employeeNumber">1</span>
                                  </summary>
                                  <table class="table table-condensed small text-muted">
                                    <caption class="wb-inv">
                                      Calculation summary for employee <span class="employeeNumber">1</span>
                                    </caption>
                                    <thead>
                                      <tr>
                                        <th scope="col">Week</th>
                                        <th scope="col">Calculated amount</th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <tr>
                                        <td>Week one</td>
                                        <td data-updates="amt-ttl-1" id="w1-amt-1">$XXX</td>
                                      </tr>
                                      <tr>
                                        <td>Week two</td>
                                        <td data-updates="amt-ttl-1" id="w2-amt-1">$XXX</td>
                                      </tr>
                                      <tr>
                                        <td>Week three</td>
                                        <td data-updates="amt-ttl-1" id="w3-amt-1">$XXX</td>
                                      </tr>
                                      <tr>
                                        <td>Week four</td>
                                        <td data-updates="amt-ttl-1" id="w4-amt-1">$XXX</td>
                                      </tr>
                                    </tbody>
                                    <tfoot>
                                      <tr>
                                        <td>4 week total</td>
                                        <td id="amt-ttl-1" data-updated-by="emp-wkly-wage-1">$XXX</td>
                                      </tr>
                                    </tfoot>
                                  </table>
                                </details>
                              </footer>
                            </fieldset>
                          </div>
                          <p class="mrgn-bttm-xl">
                            <button class="btn btn-default" id="addemp" type="button"><span
                                class="fas fa-plus-circle"></span> Add
                              another employee</button>
                            <!--<span id="remainingEmplyees">18</span> employees left </p>-->
                            <button class="btn btn-default pull-right" type="button" id="emp-calc-review"><span class="fas fa-users"></span> Review Employee calculations</button>
                        </fieldset>
                        <input id="sendTo" type="submit" name="submit" value="Send this information to the fields below"
                          class="btn btn-primary hidden">
                      </details>
                      <details>
                        <summary>
                          <h3>Spreadsheet download for 21 employees or more</h3>
                        </summary>
                        <div class="alert alert-warning">
                          <p>The calculation spreadsheet is improving based on your feedback. For accuracy, please check
                            that you made your calculations with the most recent version.</p>
                        </div>
                        <p><a href="/content/dam/cra-arc/serv-info/tax/business/topics/cews/cews-calculation.xlsx"
                            class="btn btn-primary btn-lg">Download the calculation spreadsheet (Excel)</a></p>
                        <p class="small">Current version: 2020-5</p>
                        <details class="small">
                          <summary>Version updates</summary>
                          <div class="table-responsive">
                            <table class="table small">
                              <caption class="wb-inv">
                                Version updates
                              </caption>
                              <thead>
                                <tr>
                                  <th scope="col">Release<br class="visible-xs">
                                    date</th>
                                  <th scope="col">Version</th>
                                  <th scope="col">Description</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr>
                                  <td class="nowrap"><time datetime="TBD"><span class="nowrap">2020-06-25</span> <br>
                                      <span class="nowrap">17:30:00 (EDT)</span></time>
                                  </td>
                                  <td class="nowrap">Version<br class="visible-xs">
                                    2020-5</td>
                                  <td>
                                    <ul>
                                      <li>Add period 4</li>
                                    </ul>
                                  </td>
                                </tr>
                                <tr>
                                  <td class="nowrap"><time datetime="2020-04-27 16:15"><span
                                        class="nowrap">2020-04-27</span> <br>
                                      <span class="nowrap">16:15:00 (EDT)</span></time>
                                  </td>
                                  <td class="nowrap">Version<br class="visible-xs">
                                    2020-4</td>
                                  <td>
                                    <ul>
                                      <li>Text updates (change does not affect calculation)</li>
                                    </ul>
                                  </td>
                                </tr>
                                <tr>
                                  <td class="nowrap"><time datetime="2020-04-24 19:15"><span
                                        class="nowrap">2020-04-24</span> <br>
                                      <span class="nowrap">19:15:00 (EDT)</span></time>
                                  </td>
                                  <td class="nowrap">Version<br class="visible-xs">
                                    2020-3</td>
                                  <td>
                                    <ul>
                                      <li>Batch rows moved to a separate sheet</li>
                                      <li>Layout updates to make the spreadsheet easier to complete</li>
                                      <li>More detailed instructions on how to input amounts and avoid errors</li>
                                      <li>Rounding made more accurate</li>
                                    </ul>
                                  </td>
                                </tr>
                                <tr>
                                  <td class="nowrap"><time datetime="2020-04-21 16:12"><span
                                        class="nowrap">2020-04-22</span> <br>
                                      <span class="nowrap">12:45:00 (EDT)</span></time>
                                  </td>
                                  <td class="nowrap">Version<br class="visible-xs">
                                    2020-2</td>
                                  <td>On the “Instructions and results” worksheet, the "Total Gross Payroll" label has
                                    been renamed to "Total eligible remuneration", so it matches the corresponding web
                                    application form label</td>
                                </tr>
                                <tr>
                                  <td><time datetime="2020-04-21 20:00"><span class="nowrap">2020-04-21</span><br>
                                      <span class="nowrap">09:30:00 (EDT)</span></time></td>
                                  <td class="nowrap">Version<br class="visible-xs">
                                    2020-1</td>
                                  <td>Initial worksheet</td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </details>
                        <p class="small">(If you don't have Excel, you can open the spreadsheet in free solutions like
                          Google Sheets, Numbers or OpenOffice.)</p>
                      </details>
                      <p><strong>Note:</strong> If you have an employee that also works for one or more related eligible
                        employers, the combined total CEWS amount that can be claimed for that employee between yourself
                        and any related eligible employers for each week is $847. The calculations in the <mark>online
                          calculator or</mark> spreadsheet may need to be manually adjusted if you have such employees.
                        A related eligible employer is any eligible employer that you do not deal with on an arm’s
                        length basis.</p>
                      <details>
                        <summary>Example of an adjustment for an employee working for related entities</summary>
                        <p>Westside Restaurant Ltd. (WRL) and Eastside Bar Ltd. (EBL) are both owned by the same person.
                          Mary works full time at WRL but also works weekends at EBL. Mary earns $1000 per week at WRL
                          and another $300 per week at EBL.</p>
                        <p>Using the calculation spreadsheet, WRL determines the CEWS amount related to Mary for the
                          week is $750 (75% of $1000). When EBL uses the calculation spreadsheet it shows a CEWS amount
                          of $225 (75% of $300) for Mary. However, the total of those two amounts ($750 + $225) is $975
                          – which exceeds the maximum of $847 by $128.</p>
                        <p>The claim amount of WRL or EBL will need to be manually reduced by a total of $128 so that
                          the total CEWS amount related to Mary does not exceed the $847 maximum for that week.</p>
                      </details>
                    </li>
                    <li>
                      <p class="lead">Input the values from the calculation spreadsheet</p>
                      <p>Once the spreadsheet is complete, refer to the <strong>instructions and results</strong> sheet
                        for the final values.</p>
                      <div class="row mrgn-tp-md">
                        <div class="mrgn-lft-lg mrgn-rght-md">
                          <div class="form-group">
                            <label class="control-label required" for="p2c-ee"><span class="field-name">Total number of
                                eligible employees<span class="wb-inv"> (do not include spaces or commas)</span></span>
                              <strong class="required">(required)</strong> </label>
                            <div class="row">
                              <div class="col-md-3">
                                <input required data-rule-digits="true" type="number"
                                  class="form-control input-lg text-right" id="p2c-ee">
                              </div>
                            </div>
                            <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces</strong> or
                              <strong>commas</strong></p>
                          </div>
                          <div class="form-group">
                            <label class="control-label required" for="p2c-pyrl"><span class="field-name">Total eligible
                                remuneration paid to these employees during this claim period<span class="wb-inv"> (do
                                  not include a dollar sign, commas, or decimals)</span></span> <strong
                                class="required">(required)</strong> </label>
                            <div class="input-group col-md-5">
                              <span class="input-group-addon input-sm">$</span>
                              <input required type="number" class="form-control input-lg text-right currency"
                                placeholder="00.00" step="any" id="p2c-pyrl">
                            </div>
                            <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces</strong> or:
                              <strong class="h4 mrgn-tp-0">$ , .</strong></p>
                          </div>
                          <div class="form-group">
                            <label class="control-label required" for="p2c-cews"><span class="field-name">Total basic
                                CEWS for these employees during this claim period<span class="wb-inv"> (do not include a
                                  dollar sign, commas, or decimals)</span> </span> <strong
                                class="required">(required)</strong> </label>
                            <div class="input-group col-md-5">
                              <span class="input-group-addon input-sm">$</span>
                              <input required type="number" step="any" placeholder="00.00"
                                class="form-control input-lg text-right currency" id="p2c-cews">
                            </div>
                            <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces</strong> or:
                              <strong class="h4 mrgn-tp-0">$ , .</strong></p>
                          </div>
                        </div>
                      </div>
                    </li>
                  </ol>
                  <hr class="brdr-bttm">
                  <div class="well mrgn-tp-md mrgn-bttm-lg text-muted">
                    <h3 class="mrgn-tp-0"><span class="fas fa-calculator"></span> Summary of Step 2</h3>
                    <ul class="list-unstyled lst-spcd">
                      <li> <span class="h3">Line A</span> Number of eligible employees <abbr title="equals"
                          class="brdr-0">=</abbr>
                        <output class="h3 wb-calc nowrap" for="p2c-ee"
                          data-wb-calc="{&quot;expr&quot;: &quot;#p2c-ee * 1&quot;}"></output>
                      </li>
                      <li> <span class="h3">Line B</span> Total eligible remuneration paid <abbr title="equals"
                          class="brdr-0">=</abbr>
                        <output class="h3 wb-calc nowrap" for="p2c-pyrl"
                          data-wb-calc="{&quot;expr&quot;: &quot;#p2b-pyrl * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
                      </li>
                      <li> <span class="h3">Line C</span> Basic CEWS <abbr title="equals" class="brdr-0">=</abbr>
                        <output class="h3 wb-calc nowrap" for="p2c-cews"
                          data-wb-calc="{&quot;expr&quot;: &quot;#p2c-cews * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
                      </li>
                    </ul>
                  </div>
                </fieldset>
              </li>
              <li>
                <fieldset class="brdr-tp">
                  <legend>Premiums and contributions</legend>
                  <p>Indicate the total amount of <a href="#contributions" aria-controls="contributions" class="wb-lbx"
                      role="button">premiums or contributions paid on behalf of furloughed eligible employees&nbsp;<span
                        class="far fa-question-circle"></span></a> during the selected period. Enter $0 if not
                    applicable. </p>
                  <div class="mrgn-lft-md">
                    <div class="form-group">
                      <label class="control-label required" for="p3-ei"><span class="field-name">Total EI and QPIP
                          premiums that you paid on salary to furloughed eligible employees <small>(for the claim
                            period)</small><span class="wb-inv"> (do not include a dollar sign, commas, or
                            decimals)</span></span> <strong class="required">(required)</strong> </label>
                      <div class="input-group col-md-5">
                        <span class="input-group-addon input-sm">$</span>
                        <input required step="any" placeholder="00.00" type="number"
                          class="form-control input-lg text-right currency" id="p3-ei">
                      </div>
                      <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces</strong> or: <strong
                          class="h4 mrgn-tp-0">$ , .</strong></p>
                    </div>
                    <div class="form-group">
                      <label class="control-label required" for="p3-cpp"><span class="field-name">Total CPP and QPP
                          contributions that you made on salary to furloughed eligible employees <small>(for the claim
                            period)</small><span class="wb-inv"> (do not include a dollar sign, commas, or
                            decimals)</span></span> <strong class="required">(required)</strong> </label>
                      <div class="input-group col-md-5">
                        <span class="input-group-addon input-sm">$</span>
                        <input required step="any" placeholder="00.00" type="number"
                          class="form-control input-lg text-right currency" id="p3-cpp">
                      </div>
                      <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces</strong> or: <strong
                          class="h4 mrgn-tp-0">$ , .</strong></p>
                    </div>
                  </div>
                  <hr class="brdr-bttm">
                  <div class="well mrgn-tp-md mrgn-bttm-lg text-muted">
                    <h3 class="mrgn-tp-0"><span class="fas fa-calculator"></span> Summary of Step 3</h3>
                    <ul class="list-unstyled lst-spcd">
                      <li> <span class="h3">Line D</span> Employer’s EI and QPIP premiums payable on salary paid to
                        furloughed employees <small>(for the claim period)</small> <abbr title="equals"
                          class="brdr-0">=</abbr>
                        <output class="h3 wb-calc nowrap" for="p3-ei"
                          data-wb-calc="{&quot;expr&quot;: &quot;#p3-ei * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
                      </li>
                      <li> <span class="h3">Line E</span> Employer’s CPP and QPP contributions payable on salary paid to
                        furloughed employees <small>(for the claim period)</small> <abbr title="equals"
                          class="brdr-0">=</abbr>
                        <output class="h3 wb-calc nowrap" for="p3-cpp"
                          data-wb-calc="{&quot;expr&quot;: &quot;#p3-cpp * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
                      </li>
                    </ul>
                  </div>
                </fieldset>
              </li>
              <li>
                <fieldset class="mrgn-bttm-lg">
                  <legend>Deductions </legend>
                  <div class="mrgn-lft-md">
                    <div class="form-group">
                      <label class="control-label required" for="p4-tws"><span class="field-name">Amount that you
                          calculated for the 10% Temporary Wage Subsidy for Employers <small>(for the claim
                            period)</small> (enter $0 if not applicable)<span class="wb-inv"> (do not include a dollar
                            sign, commas, or decimals)</span></span> <strong class="required">(required)</strong>
                      </label>
                      <p><a href="#tempwage" aria-controls="tempwage" class="wb-lbx" role="button">10% Temporary Wage
                          Subsidy for Employers amount&nbsp;<span class="far fa-question-circle"></span></a></p>
                      <div class="input-group col-md-5">
                        <span class="input-group-addon input-sm">$</span>
                        <input required step="any" placeholder="00.00" type="number"
                          class="form-control input-lg text-right currency" id="p4-tws">
                      </div>
                      <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces</strong> or: <strong
                          class="h4 mrgn-tp-0">$ , .</strong></p>
                    </div>
                    <div class="form-group">
                      <label class="control-label required" for="p4-wsb"><span class="field-name">Total amount that your
                          eligible employees have received under ESDC’s Work-Sharing benefit program <small>(for the
                            claim period)</small> (enter $0 if not applicable) <span class="wb-inv"> (do not include a
                            dollar sign, commas, or decimals)</span></span> <strong class="required">(required)</strong>
                      </label>
                      <p><a href="#worksharing" aria-controls="worksharing" class="wb-lbx" role="button">Work-Sharing
                          benefit program amount&nbsp;<span class="far fa-question-circle"></span></a></p>
                      <div class="input-group col-md-5">
                        <span class="input-group-addon input-sm">$</span>
                        <input required step="any" placeholder="00.00" type="number"
                          class="form-control input-lg text-right currency" id="p4-wsb">
                      </div>
                      <p class="small text-muted" aria-hidden="true">Do not include <strong>spaces</strong> or: <strong
                          class="h4 mrgn-tp-0">$ , .</strong></p>
                    </div>
                  </div>
                  <hr class="brdr-bttm">
                  <div class="well mrgn-tp-md mrgn-bttm-lg text-muted">
                    <h3 class="mrgn-tp-0"><span class="fas fa-calculator"></span> Summary of Step 4</h3>
                    <ul class="list-unstyled lst-spcd">
                      <li> <span class="h3">Line F</span> Amount calculated under the 10% Temporary Wage Subsidy for
                        Employers program <small>(for the claim period)</small> <abbr title="equals"
                          class="brdr-0">=</abbr>
                        <output class="h3 wb-calc nowrap" for="p4-tws"
                          data-wb-calc="{&quot;expr&quot;: &quot;#p4-tws * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
                      </li>
                      <li> <span class="h3">Line G</span> Amounts received by eligible employees under ESDC's
                        Work-Sharing benefit program <small>(for the claim period)</small> <abbr title="equals"
                          class="brdr-0">=</abbr>
                        <output class="h3 wb-calc nowrap" for="p4-wsb"
                          data-wb-calc="{&quot;expr&quot;: &quot;#p4-wsb * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
                      </li>
                    </ul>
                  </div>
                </fieldset>
              </li>
              <li>
                <fieldset>
                  <legend>Get results</legend>
                  <p>After completing the four steps above, you can now calculate the results.</p>
                  <p>
                    <button id="calculate" class="btn btn-primary btn-lg" type="submit">Calculate your total wage
                      subsidy</button>
                  </p>
                </fieldset>
              </li>
            </ol>
          </form>
        </div>
      </section>
      <section id="armslength" class="mfp-hide modal-dialog modal-content overlay-def">
        <header class="modal-header">
          <h2 class="modal-title">Arm's length and non-arm's length</h2>
        </header>
        <div class="modal-body">
          <dl class="dl-horizontal">
            <dt>Non-arm's length (not at arm's length)</dt>
            <dd>Generally, a “non-arm’s length” relationship is between persons who are related to each other. In a
              small business, a non-arm’s-length employee would most commonly be:
              <ul>
                <li>the person who owns the business</li>
                <li>a member of the owner’s immediate family (for example, a spouse, parent, child, sibling,
                  grandparent, or grandchild)</li>
              </ul>
              It is possible (but less common) for a non-arm’s-length employee relationship to exist between unrelated
              people, partnerships, or corporations, depending on the circumstances.
            </dd>
            <dt>Arm’s length</dt>
            <dd>Most employees that are unrelated to the owner (act in their own separate interests) are arm’s-length
              employees.</dd>
          </dl>
          <p>If you are uncertain about whether a particular employee is considered arm’s length or non-arm’s length, or
            have a business or corporation involving more complex control, you can read more about <a
              href="/en/revenue-agency/services/tax/technical-information/income-tax/income-tax-folios-index/series-1-individuals/series-1-individuals/income-tax-folio-s1-f5-c1-related-persons-dealing-arms-length.html"
              target="_blank">specific relationships that are considered non-arm’s length</a>.</p>
        </div>
      </section>
      <section id="contributions" class="mfp-hide modal-dialog modal-content overlay-def">
        <header class="modal-header">
          <h2 class="modal-title">Lines D and E - Employer’s EI, QPIP, CPP, and QPP premiums payable on salary paid to
            furloughed employees </h2>
        </header>
        <div class="modal-body">
          <p class="mrgn-tp-0">Employers can claim a 100% refund for the employer-paid part of contributions made on
            behalf of eligible employees who are furloughed for any full week in the claim period, as long as the
            employer is eligible to claim the CEWS for them. Furloughed means the eligible employee was on leave with
            full or partial pay for the full week&nbsp;&mdash; they were paid by the employer but did not perform any
            work during that week.</p>
          <p>These employer-paid contributions include:</p>
          <ul>
            <li>Employment Insurance (EI)</li>
            <li>the Canada Pension Plan (CPP)</li>
            <li>the Quebec Pension Plan (QPP), and</li>
            <li>the Quebec Parental Insurance Plan (QPIP)</li>
          </ul>
          </p>
        </div>
      </section>
      <section id="tempwage" class="mfp-hide modal-dialog modal-content overlay-def">
        <header class="modal-header">
          <h2 class="modal-title">10% Temporary Wage Subsidy for Employers amount</h2>
        </header>
        <div class="modal-body">
          <p class="lead">Line F –10% Temporary Wage Subsidy reduction for employers</p>
          <p>You will need to calculate your amount for the 10% Temporary Wage Subsidy (a separate program) before you
            enter it at Line F.</p>
          <p>Generally, the 10% Temporary Wage Subsidy for Employers is equal to:</p>
          <p class="indent-medium"><strong>10% of the remuneration you paid from March 18 to June 19, 2020, up to $1,375
              for each eligible employee</strong></p>
          <p>The total maximum of the temporary subsidy is $25,000 per employer.</p>
          <p>CEWS and the 10% Temporary Wage Subsidy for Employers are intended to provide total support of up to 75%,
            not 75% + 10%. If you are eligible for both wage subsidies for a claim period, any amount you calculate
            under the 10% Temporary Wage Subsidy for Employers in the period will reduce the amount available for you to
            claim under the CEWS in that same period.</p>
          <p>You may choose to have the 10% Temporary Wage Subsidy be less than 10% of the remuneration you paid so that
            you can receive a higher amount of Canada Emergency Wage Subsidy. If you enter 0 as your amount for the 10%
            Temporary Wage Subsidy for Employers in your CEWS application, the CEWS will be determined as if you are
            electing 0% as the prescribed percentage for 10% Temporary Wage Subsidy for Employers, and are requesting
            the maximum amount of CEWS instead.</p>
          <p>Read more: <a
              href="/en/revenue-agency/campaigns/covid-19-update/frequently-asked-questions-wage-subsidy-small-businesses.html">FAQ
              – Temporary Wage Subsidy for Employers</a></p>
        </div>
      </section>
      <section id="worksharing" class="mfp-hide modal-dialog modal-content overlay-def">
        <header class="modal-header">
          <h2 class="modal-title">Line G - Amounts received by eligible employees under ESDC's Work-Sharing benefit
            program </h2>
        </header>
        <div class="modal-body">
          <p class="mrgn-tp-0">For employers and employees that are participating in Employment and Social Development
            Canada's <a
              href="https://www.canada.ca/en/employment-social-development/corporate/notices/coronavirus/employers-factsheet.html">Work-Sharing
              benefit program</a>, EI benefits received by employees through the Work-Sharing program will reduce the
            benefit that their employer is entitled to receive under the CEWS.</p>
          <p>Enter the total amount received under the Work-Sharing program by your eligible employees during the period
            covered by this claim in the box for line G. On an administrative basis, we will accept a reasonable
            estimate of work sharing benefits received by your eligible employees if you do not have the exact amount.
          </p>
        </div>
      </section>
      <section id="pp-statement" class="mfp-hide modal-dialog modal-content overlay-def experimental">
        <header class="modal-header">
          <h2 class="modal-title">Print preview for CEWS statement</h2>
        </header>
        <div class="modal-body">
          <div data-ajax-replace=" #cews-statement"></div>
          <div data-ajax-replace=" #cews-statement-table"></div>
          <ul class="list-inline">
            <li>
              <button onclick="window.print()" class="btn btn-success btn-lg"><span
                  class="glyphicon glyphicon-print"></span> Print this statement</button>
            </li>
            <li class="pull-right">
              <button title="Close overlay" class="btn btn-sm btn-default pull-right popup-modal-dismiss"
                type="button">Close<span class="wb-inv"> overlay</span></button>
            </li>
          </ul>
        </div>
        <div class="modal-footer hidden"> </div>
      </section>
      <div class="panel panel-primary hidden" id="results">
        <header class="panel-heading">
          <h2 class="panel-title">Canada Emergency Wage Subsidy (CEWS) amount to claim</h2>
        </header>
        <div class="panel-body">
          <p class="pull-right hidden-print"><a href="#pp-statement" class="wb-lbx btn btn-default btn-lg "
              role="button"><span class="glyphicon glyphicon-print"></span> Print preview<span class="wb-inv"> CEWS
                statement</span></a></p>
          <div id="cews-statement">
            <p class="lead"><strong>You will need the amounts below when you apply for CEWS.</strong> Print and keep
              this record. You will need these line amounts when you complete your online application for CEWS.</p>
            <p>For the claim period of <strong class="claim-period"></strong>, and based on the following criteria:
            </p>
            <ul class="lst-spcd">
              <li> Line A: Number of eligible employees: <strong>
                  <output class="h3 wb-calc nowrap" for="p2c-ee"
                    data-wb-calc="{&quot;expr&quot;: &quot;#p2c-ee * 1&quot;}"></output>
                </strong> </li>
              <li> Line B: Total eligible remuneration paid: <strong>
                  <output class="h3 wb-calc nowrap" for="p2c-pyrl"
                    data-wb-calc="{&quot;expr&quot;: &quot;#p2b-pyrl * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
                </strong> </li>
              <li> Line C: Basic CEWS: <strong>
                  <output class="h3 wb-calc nowrap" for="p2c-cews"
                    data-wb-calc="{&quot;expr&quot;: &quot;#p2c-cews * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
                </strong> </li>
              <li> Line D: Employer’s EI and QPIP premiums payable on salary paid to furloughed employees <small>(for
                  the claim period)</small>: <strong>
                  <output class="h3 wb-calc nowrap" for="p3-ei"
                    data-wb-calc="{&quot;expr&quot;: &quot;#p3-ei * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
                </strong> </li>
              <li> Line E: Employer’s CPP and QPP contributions payable on salary paid to furloughed employees
                <small>(for the claim period)</small>: <strong>
                  <output class="h3 wb-calc nowrap" for="p3-cpp"
                    data-wb-calc="{&quot;expr&quot;: &quot;#p3-cpp * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
                </strong> </li>
              <li> Line F: Amount calculated under the 10% Temporary Wage Subsidy for Employers <small>(for the claim
                  period)</small>: <strong>
                  <output class="h3 wb-calc nowrap" for="p4-tws"
                    data-wb-calc="{&quot;expr&quot;: &quot;#p4-tws * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
                </strong> </li>
              <li> Line G: Amount received by eligible employees under ESDC’s Work-Sharing benefit program <small>(for
                  the claim period)</small>: <strong>
                  <output class="h3 wb-calc nowrap" for="p4-wsb"
                    data-wb-calc="{&quot;expr&quot;: &quot;#p4-wsb * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
                </strong> </li>
            </ul>
            <div class="alert alert-success">
              <h3>Result</h3>
              <p> Line H: The <strong>total amount</strong> you will claim for the CEWS for this period is: <strong>
                  <output class="h3 wb-calc nowrap" for="p2c-cews p3-ei p3-cpp p4-tws p4-wsb"
                    data-wb-calc="{&quot;expr&quot;: &quot;#p2c-ee + #p2-pyrl + #p3-ei + #p3-cpp - #p4-tws - #p4-wsb&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
                </strong> This amount is subject to verification. </p>
            </div>
          </div>
        </div>
        <table class="table" id="cews-statement-table">
          <caption>
            Summary of CEWS claim
          </caption>
          <tbody>
            <tr>
              <th scope="row">Basic CEWS <small class="nowrap">(Line C)</small></th>
              <td class="text-right nowrap"><output class="h3 wb-calc nowrap" for="p2c-cews"
                  data-wb-calc="{&quot;expr&quot;: &quot;#p2c-cews * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
              </td>
            </tr>
            <tr>
              <th scope="row">(add) EI and QPIP share <small class="nowrap">(Line D)</small></th>
              <td class="text-right nowrap">+
                <output class="h3 wb-calc nowrap" for="p3-ei"
                  data-wb-calc="{&quot;expr&quot;: &quot;#p3-ei * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
              </td>
            </tr>
            <tr>
              <th scope="row">(add) CPP and QPP share <small class="nowrap">(Line E)</small></th>
              <td class="text-right nowrap">+
                <output class="h3 wb-calc nowrap" for="p3-cpp"
                  data-wb-calc="{&quot;expr&quot;: &quot;#p3-cpp * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
              </td>
            </tr>
            <tr>
              <th scope="row">(less) 10% Temporary Wage Subsidy for Employers claim <small class="nowrap">(Line
                  F)</small></th>
              <td class="text-right nowrap"><abbr title="negative" class="brdr-0">-</abbr>
                <output class="h3 wb-calc nowrap" for="p4-tws"
                  data-wb-calc="{&quot;expr&quot;: &quot;#p4-tws * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
              </td>
            </tr>
            <tr>
              <th scope="row">(less) Work-Sharing benefit program received <small class="nowrap">(Line G)</small></th>
              <td class="text-right nowrap"><abbr title="negative" class="brdr-0">-</abbr>
                <output class="h3 wb-calc nowrap" for="p4-wsb"
                  data-wb-calc="{&quot;expr&quot;: &quot;#p4-wsb * 1&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
              </td>
            </tr>
            <tr class="success">
              <th scope="row">Your CEWS claim, subject to verification, is <small class="nowrap">(Line H)</small></th>
              <td class="text-right nowrap"><output class="h3 wb-calc nowrap"
                  for="p2c-cews p3-ei p3-cpp p4-tws p4-wsb"
                  data-wb-calc="{&quot;expr&quot;: &quot;#p2-pyrl + #p3-ei + #p3-cpp - #p4-tws - #p4-wsb&quot;, &quot;format&quot;: &quot;currency&quot;}"></output>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <section id="employeeDetails" class="mfp-hide modal-dialog modal-content overlay-def wb-popup-full">
        <header class="modal-header">
          <h2 class="modal-title">CEWS calculations for claim period <span class="claim-period"></span></h2>
        </header>
        <div class="modal-body">
          <table id="wkly-tbl" class="table table-bordered small">
            <thead>
              <tr>
                <th>Eligible employees</th>
                <th>Arm's length</th>
                <th>Average weekly gross pay 2020-01-01 to 2020-03-15</th>
                <th>Weekly gross pay for Week 1</th>
                <th>Weekly gross pay for Week 2</th>
                <th>Weekly gross pay for Week 3</th>
                <th>Weekly gross pay for Week 4</th>
                <th>Basic CEWS total</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Employee 1</td>
                <td id="emp-arms-1"></td>
                <td id="emp-base-1"></td>
                <td data-updated-by="wkly-wkone-1"></td>
                <td data-updated-by="wkly-wktwo-1"></td>
                <td data-updated-by="wkly-wkthree-1"></td>
                <td data-updated-by="wkly-wkfour-1"></td>
                <td></td>
              </tr>
            </tbody>
            <tfoot>
              <tr>
                <td class="nowrap">Total EEs: <spanc class="numEmps"></span></td>
                <td>
                  <span class="wb-inv">-</span>
                </td>
                <td>
                  <span class="wb-inv">-</span>
                </td>
                <td>
                  <span class="wb-inv">-</span>
                </td>
                <td>
                  <span class="wb-inv">-</span>
                </td>
                <td>
                  <span class="wb-inv">-</span>
                </td>
                <td>
                  <span class="wb-inv">-</span>
                </td>
                <td>
                  <span>All EE total: <span class="wkly-total"></span></span>
                </td>
              </tr>
            </tfoot>
          </table>
        </div>
        <div class="modal-footer hidden"> </div>
      </section>
      <!--This is not relevant for the estimated range output--<p>[Save or copy the result of your calculation to enter when you apply for the benefit.]</p>-->
      <nav class="mrgn-bttm-lg mrgn-tp-lg">
        <h3 class="wb-inv">Document navigation</h3>
        <ul class="pager">
          <li class="next"><a href="how-apply.html" rel="next">How to apply</a></li>
        </ul>
      </nav>
      <div class="hidden-md hidden-lg" data-ajax-replace="index.html #related-menu>"> </div>
    </section>
    <div id="def-preFooter"></div>
    <!-- Write closure template -->
    <script type="text/javascript">
      var defPreFooter = document.getElementById("def-preFooter");
      defPreFooter.outerHTML = wet.builder.preFooter({
        dateModified: "2020-04-20",
        showPostContent: true,
        showFeedback: true,
        showShare: true
      });
    </script>
  </main>
  <div id="def-footer"></div>
  <!-- Write closure template -->
  <script type="text/javascript">
    var defFooter = document.getElementById("def-footer");
    defFooter.outerHTML = wet.builder.footer({
      showFooter: true,
      showFeatures: true
    });
  </script>
  <!-- Write closure template -->
  <script type="text/javascript">
    document.write(wet.builder.refFooter({
    }));
  </script>
  <script src="https://test.canada.ca/covid-19-guidance/proto/js/alpha-banner.js"></script>
  <script>
    /**
     * EmployeeFormGenerator class
     * used to help creating new employee wage forms based on the chosen pay 
     * schedule
     * @author Michel Tremblay
     */
    var EmployeeFormGenerator = (function () {

      /**
       * Constructor
       * 
       * @param {Int} paySchedule the numeric value of the chosen pay schedule
       */
      function EmployeeFormGenerator(paySchedule) {
        //the payschedule chosen by the user
        this.paySchedule = paySchedule;
        //variables to avoid magic numbers & strings
        this.prefix = "";
        this.numberOfEmployees = 1;
        this.weekly = 1;
        this.biWeekly = 2;
        this.weeklyPrefix = "wkly-";
        this.weeklyTemplateId = this.weeklyPrefix + "emp-1";
        this.biWeeklyTemplateId = this.biWeeklyPrefix + "emp-1";
        this.armsLengthId = "arms-";
        this.baselineId = "baseline-"
        this.employeeNumberClass = "employeeNumber";
        this.removeablePanelClass = "extra-emp-pnl";
        this.currencyPlaceholderValue = "$XXX";
        this.weeklySummaryBaseClass = "emp-wkly-wage-1";
        this.weeklySummaryClass = "emp-wkly-wage-";
        this.employeeIndexRegex = /-1$/g;
        this.templateId = this.weeklyTemplateId;
        this.prefix = this.weeklyPrefix
      }

      /**
       * generateNewEmployeeForm
       * 
       * function called to run the routine to generate the new form
       * 
       * @param {Int} numEmps the number of employee panels currently on the 
       * page
       * 
       * @return {DOMDocumentFragment} the cloned template with ID's and other 
       * attributes updated for use in as a new employee wage form
       */
      EmployeeFormGenerator.prototype.generateNewEmployeeForm = function (numEmps) {
        //update number of employee frames
        this.numberOfEmployees = numEmps;
        //generate another pay form
        var newForm = this.generateNewForm();
        return newForm;
      }

      /**
       * generateNewForm
       * 
       * clone the template DOM element and update the required attributes for 
       * a new employee wage form
       * 
       * @calls EmployeeFormGenerator::updateArmsLengthElementId()
       * @calls EmployeeFormGenerator::updateBaselineWageElementId() to update 
       * the baseline wage element
       * @calls EmployeeFormGenerator::setUpdatesAndUpdatedByData() to update 
       * the data-updates and data-update-by attributes
       * @calls EmployeeFormGenerator::updateInputs() to update the input fields
       * @calls EmployeeFormGenerator::updateTableIds() to update the summary 
       * table cells
       * 
       * @return {DOMDocumentFragment} the update DOM fragment to be used as 
       * the new employee wage form
       */
      EmployeeFormGenerator.prototype.generateNewForm = function () {
        var frag = document.getElementById(this.templateId);
        //clone the document fragment, with all children, and all attributes
        frag = $(frag).clone();
        //update the frame id
        $(frag).attr("id", $(frag).attr("id").replace("-1", "-" + this.numberOfEmployees));
        //add class that will be used to identify panels to remove when the selected pay schedule is changed
        $(frag).addClass(this.removeablePanelClass);
        //update the employee number text
        var numEmps = this.numberOfEmployees;
        $(frag).find("." + this.employeeNumberClass).each(function (e, element) {
          $(element).text(numEmps);
        });
        //add the aria-live=polite attr for screen readers
        $(frag).attr("aria-live", "polite");
        //update the DOM fragment
        this.updateArmsLengthElementId(frag);
        this.updateBaselineWageElementId(frag);
        this.setUpdatesAndUpdatedByData(frag);
        this.updateInputs(frag);
        this.updateTableIds(frag);
        return frag;
      }

      /**
       * updateArmsLengthElementId
       * 
       * update the arms length dropdown element
       * 
       * @param {DOMDocumentFragment} frag the cloned template
       */
      EmployeeFormGenerator.prototype.updateArmsLengthElementId = function (frag) {
        var armsLengthElement = $(frag).find(
          "#" + this.prefix + this.armsLengthId + "1"
        );
        $(armsLengthElement).attr("id", $(armsLengthElement).attr("id").replace(this.employeeIndexRegex, "-" + this.numberOfEmployees));
        $(armsLengthElement).first("option").attr("selected", true);
      }

      /**
       * updateBaselineWageElementId
       * 
       * update the baseline wage input id and reset the value
       * 
       * @param {DOMDocumentFragment} frag the cloned template
       */
      EmployeeFormGenerator.prototype.updateBaselineWageElementId = function (frag) {
        var baselineWageElement = $(frag).find(
          "#" + this.prefix + this.baselineId + "1"
        );
        $(baselineWageElement).attr("id", $(baselineWageElement).attr("id").replace(this.employeeIndexRegex, "-" + this.numberOfEmployees));
        $(baselineWageElement).val(null);
      }

      /**
       * setUpdatesAndUpdatedByData
       * 
       * increment the date-updates and data-updated-by value so the 
       * appropriate summary table is updated
       * 
       * @param {DOMDocumentFragment} frag the cloned template
       */
      EmployeeFormGenerator.prototype.setUpdatesAndUpdatedByData = function (frag) {
        var updateElements = $(frag).find("*[data-updates$='-1']");
        var updatedByElements = $(frag).find("*[data-updated-by$='-1']");
        var numEmps = this.numberOfEmployees;
        var indexRegex = this.employeeIndexRegex;
        $(updateElements).each(function (i, element) {
          var newval = $(element).data("updates").replace(indexRegex, "-" + numEmps);
          $(element).attr("data-updates", newval);
        });
        $(updatedByElements).each(function (i, element) {
          var newval = $(element).data("updated-by").replace(indexRegex, "-" + numEmps)
          $(element).attr("data-updated-by", newval);
        });
      }

      /**
       * updateInputs
       * 
       * update the id, class, and value for the new inputs. also update the 
       * label 'for' value with the new input id
       * 
       * @param {DOMDocumentFragment} frag the cloned template
       */
      EmployeeFormGenerator.prototype.updateInputs = function (frag) {
        var inputs = $(frag).find("input[id$='-1']");
        var numEmps = this.numberOfEmployees;
        var weeklyBaseClass = this.weeklySummaryBaseClass;
        var weeklyClass = this.weeklySummaryClass;
        var indexRegex = this.employeeIndexRegex;
        $(inputs).each(function (i, element) {
          //need to get the label for each of these elements and update the 'for' attr
          var label = $(frag).find("label[for='" + $(element).attr("id") + "']");
          $(element).attr("id", $(element).attr("id").replace(indexRegex, "-" + numEmps)
          );
          $(element).val(null);
          $(label).attr("for", $(label).attr("for").replace(indexRegex, "-" + numEmps)
          );
          //update the class that drives employee wage summary 
          if ($(element).hasClass(weeklyBaseClass)) {
            $(element).removeClass(weeklyBaseClass);
            $(element).addClass(weeklyClass + numEmps);
          }
        });
      }

      /**
       * updateTableIds
       * 
       * update table cell id and values required for employee wage summary
       * 
       * @param {DOMDocumentFragment} frag the cloned template
       */
      EmployeeFormGenerator.prototype.updateTableIds = function (frag) {
        var tds = $(frag).find("td[id$='-amt-1']");
        var totalCell = $(frag).find("td[id$='ttl-1']");
        var numEmps = this.numberOfEmployees;
        var currencyPlaceholderValue = this.currencyPlaceholderValue;
        var indexRegex = this.employeeIndexRegex;
        $(tds).each(function (i, element) {
          $(element).attr("id", $(element).attr("id").replace(indexRegex, "-" + numEmps));
          $(element).text(currencyPlaceholderValue);
        });
        $(totalCell).attr("id", $(totalCell).attr("id").replace(indexRegex, "-" + numEmps));
        $(totalCell).text(currencyPlaceholderValue);
      }

      return EmployeeFormGenerator;
    })();

  </script>
  <script>
    (function ($, window, wb) {
      "use strict";
      /*
      * Variable and function definitions.
      * These are global to the plugin - meaning that they will be initialized once per page,
      * not once per instance of plugin on the page. So, this is a good place to define
      * variables that are common to all instances of the plugin on a page.
      */
      // function that should be moved as a helper class or something
      const toMoney = new Intl.NumberFormat(wb.lang + "-CA", {
        style: "currency",
        currency: "CAD",
        minimumFractionDigits: 2
      });
      var employeeFormGenerator = new EmployeeFormGenerator();
      var componentName = "wb-calc",
        selector = "." + componentName,
        initEvent = "wb-init" + selector,
        $document = wb.doc,
        defaults = {},
        sep = {
          iso: {
            en: "--",
            fr: "--"
          },
          claim: {
            en: " to ",
            fr: " au "
          }
        },
        /**
         * @method init
         * @param {jQuery Event} event Event that triggered the function call
         */
        init = function (event) {
          // Start initialization
          // returns DOM object = proceed with init
          // returns undefined = do not proceed with init (e.g., already initialized)

          var elm = wb.init(event, componentName, selector),
            $elm,
            settings;

          if (elm) {
            $elm = $(elm);
            // ... Do the plugin initialisation
            // Get the plugin JSON configuration set on attribute data-wb-helloworld
            settings = $.extend(
              true,
              {},
              defaults,
              window[componentName],
              wb.getData($elm, componentName)
            );

            // Call my custom event
            $elm.trigger("change", settings);
            // Identify that initialization has completed
            wb.ready($elm, componentName);
          }
        };

      // Plugin event handlers
      $document.on("change", "input", function (event) {
        var elm = event.currentTarget,
          $elm = $(elm),
          $elmId = $elm.attr("id"),
          data = wb.getData($("output[for='" + $elmId + "']"), componentName),
          value = $elm.val().replace(/\,\s/g, ''), // Needs to be replaced by data.expr evaluation
          total = 0;

        if (data.expr) {
          if (data.format === "currency") {
            $("output[for='" + $elmId + "']").html(toMoney.format(value * 1));
          } else {
            $("output[for='" + $elmId + "']").html(value * 1);
          };
        }

        total = ($("#p2c-cews").val() * 1) + ($("#p3-ei").val() * 1) + ($("#p3-cpp").val() * 1) - ($("#p4-tws").val() * 1) - ($("#p4-wsb").val() * 1);
        if (total < 0) {
          $("[for='p2c-cews p3-ei p3-cpp p4-tws p4-wsb']").html(toMoney.format(0));
        } else {
          $("[for='p2c-cews p3-ei p3-cpp p4-tws p4-wsb']").html(toMoney.format(total));
        };
      });

      $document.on("change", selector, function (event, data) {
        var elm = event.currentTarget,
          $elm = $(elm),
          $input = $("#" + $elm.attr("for")),
          value = $input.val();

        if (data && data.format === "currency") {
          $elm.html(toMoney.format(value * 1));
        } else {
          $elm.html(value * 1);
        };
        $("[for='p2c-ee p2c-pyrl p2c-cews p3-ei p3-cpp p4-tws p4-wsb']").html(toMoney.format(0));
      });

      $document.on("change", "#claim-period", function (event) {
        var rangeISO = $(this).find('option:selected').val(),
          startDateISO = rangeISO.substring(0, rangeISO.indexOf(sep.iso[wb.lang])),
          endDateISO = rangeISO.substring(rangeISO.indexOf(sep.iso[wb.lang]) + sep.iso[wb.lang].length, rangeISO.length),
          rangeClaim = $(this).find("option:selected").text(),
          startDateClaim = rangeClaim.substring(0, rangeClaim.indexOf(sep.claim[wb.lang])),
          endDateClaim = rangeClaim.substring(rangeClaim.indexOf(sep.claim[wb.lang]) + sep.claim[wb.lang].length, rangeClaim.length);

        if (!$("#claim-period option:selected:eq(0)")) {
          $('.claim-period').html("<time datetime=\"" + startDateISO + "\">" + startDateClaim + "</time>" + sep.claim[wb.lang] + "<time datetime=\"" + endDateISO + "\">" + endDateClaim + "</time>");
        } else {
          $('.claim-period').html($("#claim-period option:selected").text());
        }
        /**
         * display rate reduction calculator for P5+
         * @author Michel Tremblay
         */
        if (
          parseInt($("#claim-period option:selected").data("claim-period")) >= 5
        ) {
          $("#rate-reduction").removeClass("hidden");
          $("#reduction-percent-panel").removeClass("hidden");
        } else {
          $("#rate-reduction").addClass("hidden");
          $("#reduction-percent-panel").addClass("hidden");
        }
      });

      $document.on("click", "#calculate", function (event) {
        event.preventDefault();
        var count = 0,
          $elms = $(".wb-frmvld select[required], .wb-frmvld input[required]"),
          $emptyElms = [];

        for (let i = 0; i < $($elms).length; i++) {
          var $elm = $($elms).eq(i);
          if ($elm.val() == "") {
            $emptyElms.push($elm);
            count++;
          }
        }

        if ($("#errors-default")[0]) {
          $('html, body').animate({ scrollTop: $("#errors-default").offset().top }, 'slow');
        } else if ($emptyElms[0]) {
          $('html, body').animate({ scrollTop: $($emptyElms[0]).offset().top }, 'slow');
          console.debug($emptyElms);
        } else {
          $("#results").removeClass("hidden");
        }
      });

      /**
       * @author Michel Tremblay
       */
      //show the employee calculation review modal
      $document.on("click", "#emp-calc-review", function (event) {
        $document.trigger('open.wb-lbx', [
            [
              {
                src: "#employeeDetails",
                type: "inline"
              }
            ],
            false
          ]);
      })

      /**
       * @author Michel Tremblay
       * convert currency fields to two decimal places
       */
      $document.on("blur", ".currency", function (event) {
        var target = event.target;
        var formattedVal = parseFloat($(target).val()).toFixed(2);
        $(target).val(formattedVal);
      });

      /**
       * @author Michel Tremblay
       * update the employee wage summary
       */
      $document.on("blur", "*[data-updates]", function (event) {
        var target = event.target;
        var updateTarget = $("#" + $(target).attr("data-updates"));
        if (target.nodeName == 'SELECT') {
          var formattedVal = target.value.charAt(0).toUpperCase() + target.value.slice(1);
          $(updateTarget).text(formattedVal);
        } else {
          var formattedVal = toMoney.format(target.value);
          $(updateTarget).text(formattedVal);
          var updatedByElements = $("*[data-updated-by='" + target.id + "']");
          $(updatedByElements).each(function (i, element) {
            $(element).text(formattedVal);
          });
          //update the total
          if ($(updateTarget).data("updates")) {
            /*
              update the target to the total column and get all elements that make up the total
            */
            updateTarget = $("#" + $(updateTarget).attr("data-updates"));
            var elements = $("." + $(updateTarget).attr("data-updated-by"));
            var total = 0;
            //get the total wage
            $(elements).each(function (i, element) {
              formattedVal = $(element).val();
              if (parseFloat(formattedVal)) {
                total += parseFloat(formattedVal);
              }
            });
            //format the wage and update the total
            var formattedTotal = toMoney.format(total);
            $(updateTarget).text(formattedTotal);
          }
        }
      });

      /**
       * @author Michel Tremblay
       * add a new employee form  
       */
      var numEmployeePanels = 1;
      $("#addemp").on("click", addEmp);
      $("#addemp").on("keypress", addEmp);
      function addEmp() {
        numEmployeePanels++;
        var frag = employeeFormGenerator.generateNewEmployeeForm(
          numEmployeePanels
        );
        //create new row for the calculation table
        var row = document.createElement("tr");
        row.id = "emp" + numEmployeePanels;
        //create the employee 'name' cell
        var eligibleEmployeeCell = document.createElement("td");
        eligibleEmployeeCell.innerHTML = "Employee " + numEmployeePanels;
        // create the arms length cell 
        var armsLengthCell = document.createElement("td");
        armsLengthCell.id = "emp-arms-" + numEmployeePanels;
        //create the cell for the baseline wage
        var baselineCell = document.createElement("td");
        baselineCell.id = "emp-base-" + numEmployeePanels;
        //create cells for each wage entry
        var weeklyWageCells = [];
        for (var i = 0; i < 4; i++) {
          weeklyWageCells[i] = document.createElement("td");
        }
        //add the data-update-by attr so these cells are populated by the blur event on *[data-updates]
        $(weeklyWageCells[0]).attr(
          "data-updated-by", 
          "wkly-wkone-" + numEmployeePanels
        ); 
        $(weeklyWageCells[1]).attr(
          "data-updated-by", 
          "wkly-wktwo-" + numEmployeePanels
        );
        $(weeklyWageCells[2]).attr(
          "data-updated-by", 
          "wkly-wkthree-" + numEmployeePanels
        );
        $(weeklyWageCells[3]).attr(
          "data-updated-by", 
          "wkly-wkfour-" + numEmployeePanels
        );
        //create the total cell
        var totalCell = document.createElement("td");
        //put the row together
        row.appendChild(eligibleEmployeeCell);
        row.appendChild(armsLengthCell);
        row.appendChild(baselineCell);
        $(weeklyWageCells).each(function (i, element) { 
          row.appendChild(weeklyWageCells[i]);
        });
        //add the row to the table
        row.appendChild(totalCell);
        $("#wkly-tbl > tbody").append(row);
        $(frag).appendTo("#employeeDiv");
        $("#remainingEmplyees").text(
          parseInt($("#remainingEmplyees").text()) - 1
        );
      }

      /**
       * @author Michel Tremblay
       * calculate the cews rate reductions
       */
      $document.on("blur", ".cews-rate-calc", function(event) {
        var cewsRateElements = $('.cews-rate-calc');
        var allDataEntered = true;
        $(cewsRateElements).each(function (i, element) {
          var value = $(element).val();
          if (value == null || value == "") {
            allDataEntered = false;
          }
        });
        if (allDataEntered) {
          //find the claim month based on the chosen claim period
          var claimMonth = new Date(
            "2020-" + getClaimMonth($("#claim-period").val()) + '-01'
          ).getUTCMonth();
          //get the value of the claim month
          var claimMonth2020Value = parseFloat($("#2020-0" + claimMonth + "-no").val());
          var claimMonth2019Value = parseFloat($("#2019-0" + claimMonth + "-no").val());
          //get the previous month from the claim month
          var prevClaimMonth = claimMonth - 1;
          //get the value of the previous month
          var prevClaim2020Value = parseFloat($("#2020-0" + prevClaimMonth + "-no").val());
          var prevClaim2019Value = parseFloat($("#2019-0" + prevClaimMonth + "-no").val());
          //get the avg of the revenue from apr-june2020
          var threeMonthAvg2020 = (parseFloat($("#2020-04-no").val()) + parseFloat($("#2020-05-no").val()) + parseFloat($("#2020-06-no").val())) / 3;
          //get the avg of the revenue from apr-june2019
          var threeMonthAvg2019 = (parseFloat($("#2019-04-no").val()) + parseFloat($("#2019-05-no").val()) + parseFloat($("#2019-06-no").val())) / 3;
          //get the rate reduction from the three month average
          var threeMonthReduction = (threeMonthAvg2019 - threeMonthAvg2020) / threeMonthAvg2019;
          //get the revenue reduction from claim/prev claim months from 2020 and 2019
          var revReduction = Math.max(
            (claimMonth2019Value - claimMonth2020Value) / claimMonth2019Value,
            (prevClaim2019Value - prevClaim2020Value) / prevClaim2019Value
          );
          //get the base rate
          var baseRate = getP5PlusBaseRate(revReduction);
          //get the top-up rate
          var topUpRate = Math.max(getP5PlusTopUpRate(threeMonthReduction), 0);
          //calculate the overall rate
          var cewsRate = baseRate + topUpRate;
          //update the view
          $("#cews-rate").text(cewsRate * 100 + "%");
          $("#rev-reduc-base").text(baseRate * 100 + "%");
          $("#top-up-rate").text(topUpRate * 100 + "%");
        }
      });

      /**
       * @author Michel Tremblay
       * calculate the cews rate reductions with alternate baseline
       */
      $document.on("blur", ".cews-rate-calc-alt", function(event) {
        //get all elements used for this calculation
        var cewsRateElements = $('.cews-rate-calc-alt');
        //if user hasnt entered values for each field, dont calculate
        var allDataEntered = true;
        $(cewsRateElements).each(function (i, element) {
          var value = $(element).val();
          if (value == null || value == "") {
            allDataEntered = false;
          }
        });
        //if user entered all required data
        if (allDataEntered) {
          //get the jan+feb avg
          var janRev = parseFloat($("#2020-01-yes").val());
          var febRev = parseFloat($("#2020-02-yes").val());
          var baseRev = (janRev + febRev) / 2;
          //find the claim month based on the chosen claim period 
          var claimMonth = new Date(
            "2020-" + getClaimMonth($("#claim-period").val()) + '-01'
          ).getUTCMonth();
          //get the value of the claim month
          var claimMonthValue = parseFloat($("#2020-0" + claimMonth + "-yes").val());
          //get the previous month from the claim month
          var prevClaimMonth = claimMonth - 1;
          //get the value of the previous month
          var prevClaimValue = parseFloat($("#2020-0" + prevClaimMonth + "-yes").val());
          //get the avg of the revenue from apr-june
          var threeMonthAvg = (parseFloat($("#2020-04-yes").val()) + parseFloat($("#2020-05-yes").val()) + parseFloat($("#2020-06-yes").val())) / 3;
          //get the rate reduction from the three month average
          var threeMonthReduction = (baseRev - threeMonthAvg) / baseRev;
          //get the revenue reduction
          var revReduction = Math.max(
            (baseRev - claimMonthValue) / baseRev,
            (baseRev - prevClaimValue) / baseRev
          );
          //get the base rate
          var baseRate = getP5PlusBaseRate(revReduction);
          //get the top-up rate
          var topUpRate = Math.max(getP5PlusTopUpRate(threeMonthReduction), 0);
          //calculate the overall rate
          var cewsRate = baseRate + topUpRate;
          //update the view
          $("#top-up-rate-alt").text(topUpRate * 100 + "%");
          $("#rev-reduc-alt-base").text(baseRate * 100 + "%");
          $("#cews-rate-alt").text(cewsRate * 100 + "%");
        }
      });

      /**
       * getClaimMonth()
       * 
       * get the month where the claim period mostly falls
       * 
       * @author Michel Tremblay
       * 
       * @param {Int} dateRange the claim period dates in 
       * YYYY-MM-DD--YYYY--MM-DD format
       * 
       * @return {Int} the claim month in numeric form 
       */
      function getClaimMonth(dateRange) {
        var dates = dateRange.split('--');
        var date1Arr = dates[0].split("-");
        var date2Arr = dates[1].split("-");
        var date1 = new Date(Date.UTC(date1Arr[0], date1Arr[1], date1Arr[2]));
        var date2 = new Date(Date.UTC(date2Arr[0], date2Arr[1], date2Arr[2]));
        var date1Counter = 0;
        var date1Month = date1.getUTCMonth();
        while (date1Month == date1.getUTCMonth()) {
          date1Counter++;
          date1.setUTCDate(date1.getUTCDate() + 1);
        }
        var date2Counter = 0;
        var date2Month = date2.getUTCMonth();
        while (date2Month == date2.getUTCMonth()) {
          date2Counter++;
          date2.setUTCDate(date2.getUTCDate() - 1);
        }
        if (parseInt(date1Counter) < parseInt(date2Counter)) {
          return date2Month + 1;
        } else if (parseInt(date1Counter) > parseInt(date2Counter)) {
          return date1Month + 1;
        } else {
          return null;
        }
      }

      /**
       * @author Michel Tremblay
       */
      function getP5PlusTopUpRate(reduction) {
        if (1.25 * reduction - 0.5 > 0.25) {
          return 0.25;
        } else {
          return 1.25 * reduction - 0.5;
        }
      }

      /**
       * @author Michel Tremblay
       */
      function getP5PlusBaseRate(revReduction) {
        //max base and period for P5+
        var maxBase = [0.6, 0.6, 0.5, 0.4, 0.2];
        var period = $("#claim-period option:selected").data("claim-period");
        if (1.25 * revReduction > maxBase[period - 5]) {
          return 0.5;
        } else {
          return 1.2 * revReduction;
        }
      }

      /**
       * @author Michel Tremblay
       */
      function oldFormula(armsLength, weeklyRemun, baselineRemun) {
        if(armsLength) {
          return Math.min(1129, weeklyRemun, baselineRemun) * 0.75;
        } else {
          return Math.max(
            Math.min(0.75 * weeklyRemun, 847),
            Math.min(0.75 * baselineRemun, weeklyRemun, 847)
          );
        }
      }

      /**
       * @author Michel Tremblay
       */
      function newFormula(armsLength, weeklyRemun, baselineRemun, overall) {
        if(armsLength) {
          return Math.min(1129, weeklyRemun, baselineRemun) * overall;
        } else {
          return Math.min(1129, weeklyRemun) * overall;
        }
      }

      // Bind the init event of the plugin
      $document.on("timerpoke.wb " + initEvent, selector, init);
      // Add the timer poke to initialize the plugin
      wb.add(selector);
    })(jQuery, window, wb);
    $(document).on("wb-ready.wb", function () {
      //allow wet4 to initialize on these fields then hide them. This solves the issue where the input fields still use periods ('.') rather than commas (',') in french
      /**
       * @author Michel Tremblay
       */
      $("#rate-reduction").addClass("hidden");
      $("#reduction-percent-panel").addClass("hidden");
    });
           // TODO: Escape commas and whitespaces in input[type=number] in IE and Edge(Trident)
  </script>
</body>

</html>